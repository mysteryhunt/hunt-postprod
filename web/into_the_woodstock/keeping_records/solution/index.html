---
layout: into_the_woodstock_solution
title: Keeping Records
class: puzzle solution
style: style.css
credits: by Kai Huang
---
<p>
For ease of reading, throughout this solution write-up, we&rsquo;ve broken up the message strings into two equal-length parts.
</p>

<p>
<b>Step 1:</b>
</p>

<p>
Upon studying the given message (or string of letters, rather), you may notice there are some meaningful blocks of words hidden within: OCEANENG, OLDCOURSE, and NUMBER. These are highlighted below:</p>
<pre>JHBXRJQDPKYGJBSHBGIGCHUMGOWHDHUMGIBJHLORKPCGWXORGJGURDHVPXUPSYTUVHDGJHXAZBTPVFXXCQGMMNLICOJJO
KSIXZMCBBHB<span class="kr-msg-block">OCEANENG</span>NGCIGOYPTE<span class="kr-msg-block">OLDCOURSE</span>LPQDFZEOEBJASKFIBHIELDTIUG<span class="kr-msg-block">NUMBER</span>TNDHIZWAWKEJHZQIAJZFXFU
</pre>

<p>The lengths of these blocks match the numbers in the first group of codes: &ldquo;8mc 9mce 6sc&rdquo;, giving confirmation that you&rsquo;ve found the right blocks. Other substrings that may look meaningful do not match the given codes, and thus are mere coincidences. Furthermore, each code contains &ldquo;m&rdquo; or &ldquo;s&rdquo;, meaning that the associated block should have multiple words or a single word, respectively.
</p><p>
The clue OCEAN ENG OLD COURSE NUMBER clues the number 13, which in turn clues the fact that the Rot13 cipher was used to create this message. So decrypt the message using Rot13.</p>

<pre>Cipher: JHBXRJQDPKYGJBSHBGIGCHUMGOWHDHUMGIBJHLORKPCGWXORGJGURDHVPXUPSYTUVHDGJHXAZBTPVFXXCQGMMNLICOJJO
        KSIXZMCBBHBOCEANENGNGCIGOYPTEOLDCOURSELPQDFZEOEBJASKFIBHIELDTIUGNUMBERTNDHIZWAWKEJHZQIAJZFXFU
Plain:  WUOKEWDQCXLTWOFUOTVTPUHZTBJUQUHZTVOWUYBEXCPTJKBETWTHEQUICKHCFLGHIUQTWUKNMOGCISKKPDTZZAYVPBWWB
        XFVKMZPOOUOBPRNARATATPVTBLCGRBYQPBHEFRYCDQSMRBROWNFXSVOUVRYQGVHTAHZOREGAQUVMJNJXRWUMDVNWMSKSH
</pre>
<p>
Note: An <a href="http://rumkin.com/tools/cipher/rot13.php">online tool</a> is available to do Rot13 decryption.
</p>

<p>
<b>Step 2:</b>
</p>

<p>
In the new message, there is once again a clue hidden within, where the lengths of the message blocks match the numbers given in the next group of codes provided: 8mk 7mke. These are highlighted below:</p>

<pre>WUOKEWDQCXLTWOFUOTVTPUHZTBJUQUHZTVOWUYBEXCPTJKBETW<span class="kr-msg-block">THEQUICK</span>HCFLGHIUQTWUKNMOGCISKKPDTZZAYVPBWWB
XFVKMZPOOUOBPRNARATATPVTBLCGRBYQPBHEFRYCDQSMR<span class="kr-msg-block">BROWNFX</span>SVOUVRYQGVHTAHZOREGAQUVMJNJXRWUMDVNWMSKSH
</pre>
<p>
In this step, the codes contain a &ldquo;k&rdquo; for key as opposed to a &ldquo;c&rdquo; for cipher as in the previous step. This is because in the previous step, the clue was cluing the name of the cipher used (Rot13), whereas in this step, the clue is cluing the encryption key. Note there is no explicit clue for what cipher is used in this step. You need to deduce the cipher from the format of the key.
</p><p>
The clue THE QUICK BROWN FX clues the sentence &ldquo;The quick brown fox jumps over the lazy dog.&rdquo;, which is the most well-known English pangram (sentence containing all 26 letters of the alphabet). Notice that &ldquo;FX&rdquo; is missing the &ldquo;O&rdquo; from the word FOX, hinting that the pangram should be used to provide a permutation of the 26 letters, only recording each letter the first time it appears in the pangram. The completed permutation is THEQUICKBROWNFXJMPSVLAZYDG. This permutation defines the cipher. Decrypt the message.</p>

<pre>Cipher alphabet: THEQUICKBROWNFXJMPSVLAZYDG
Cipher: WUOKEWDQCXLTWOFUOTVTPUHZTBJUQUHZTVOWUYBEXCPTJKBETWTHEQUICKHCFLGHIUQTWUKNMOGCISKKPDTZZAYVPBWWB
        XFVKMZPOOUOBPRNARATATPVTBLCGRBYQPBHEFRYCDQSMRBROWNFXSVOUVRYQGVHTAHZOREGAQUVMJNJXRWUMDVNWMSKSH
Plain:  LEKHCLYDGOUALKNEKATAREBWAIPEDEBWATKLEXICOGRAPHICALABCDEFGHBGNUZBFEDALEHMQKZGFSHHRYAWWVXTRILLI
        ONTHQWRKKEKIRJMVJVAVARTAIUGZJIXDRIBCNJXGYDSQJIJKLMNOSTKETJXDZTBAVBWKJCZVDETQPMPOJLEQYTMLQSHSB
</pre>
<p>
Note: An <a href="http://ruffnekk.stormloader.com/monosubst_tool.html">online tool</a> is available.
</p>

<p>
<b>Step 3:</b>
</p>

<p>
Once again, find the message blocks matching the next given group of codes: 15sk 10ske. (Ignore the &ldquo;e&rdquo; in some codes for now, since it&rsquo;s for extraction of the final answer at the end of the puzzle.)</p>
<pre>LEKHCLYDGOUALKNEKATAREBWAIPEDEBWATK<span class="kr-msg-block">LEXICOGRAPHICAL</span>ABCDEFGHBGNUZBFEDALEHMQKZGFSHHRYAWWVX<span class="kr-msg-block">TRILLI
ONTH</span>QWRKKEKIRJMVJVAVARTAIUGZJIXDRIBCNJXGYDSQJIJKLMNOSTKETJXDZTBAVBWKJCZVDETQPMPOJLEQYTMLQSHSB
</pre>
<p>
The clue LEXICOGRAPHICAL TRILLIONTH clues that this message was encrypted with another permutation of the alphabet. This time, it is the trillionth permutation in the lexicographical ordering of the permutations.
</p><p>
In order to find the trillionth permutation, we need to consider how many full iterations of each letter position have already happened in the previous 999,999,999,999 permutations.
</p><p>
First note that 999,999,999,999 is greater than 14! but less than 15!, which means the trillionth permutation doesn&rsquo;t yet get through a full cycling of the last 15 letters (yes, we could have used the septillionth permutation instead, but we&rsquo;re not that mean). So the first 11 letters of the alphabet are still the same. The 12th letter (i.e. the first one of the last 15 letters) is the first letter that changes.
</p>
<pre>First 11 letters (unchanged): ABCDEFGHIJK
Last 15 letters (reordered):  LMNOPQRSTUVWXYZ
</pre>
<p>
Since 999,999,999,999 = 14! * 11.4707456, we know that the last 14 letters have gone through 11 full cycles, which means we&rsquo;re currently in the 12th cycling of the last 14 letters. This means the 12th letter (i.e. the first one of the last 15 letters) is currently on its 12th possible value in the lexicographical ordering of the last 15 letters. The 12th possible value in the last 15 letters is the letter W. Thus we&rsquo;ve deduced the first portion of the trillionth permutation up to the 12th letter.
</p>
<pre>First portion of trillionth permutation: ABCDEFGHIJKW...
</pre>
<p>
We can continue in this manner to deduce the full trillionth permutation. Specifically, the number 999,999,999,999 is broken down as follows:
</p>
<div class="kr-math">
11 * 14! + 6 * 13! + 7 * 12! + 8 * 11! + 1 * 10! + 1 * 9! + 8 * 8! + 2 * 7! + 2 * 6! + 5 * 5! + 1 * 4! + 2 * 3! + 1 * 2! + 1 * 1!
</div>
<p>
So we want the 12th possible value of the 12th letter, followed by the 7th possible value (out of the remaining letters) of the 13th letter, and so forth. The full trillionth permutation is then
</p>
<pre>Trillionth permutation: ABCDEFGHIJKWRTVMNZPQYOUSXL
</pre>
<p>
Decrypt the message using this permutation.
</p>
<pre>Cipher alphabet: ABCDEFGHIJKWRTVMNZPQYOUSXL
Cipher: LEKHCLYDGOUALKNEKATAREBWAIPEDEBWATKLEXICOGRAPHICALABCDEFGHBGNUZBFEDALEHMQKZGFSHHRYAWWVXTRILLI
        ONTHQWRKKEKIRJMVJVAVARTAIUGZJIXDRIBCNJXGYDSQJIJKLMNOSTKETJXDZTBAVBWKJCZVDETQPMPOJLEQYTMLQSHSB
Plain:  ZEKHCZUDGVWAZKQEKANAMEBLAISEDEBLANKZEYICVGMASHICAZABCDEFGHBGQWRBFEDAZEHPTKRGFXHHMUALLOYNMIZZI
        VQNHTLMKKEKIMJPOJOAOAMNAIWGRJIYDMIBCQJYGUDXTJIJKZPQVXNKENJYDRNBAOBLKJCRODENTSPSVJZETUNPZTXHXB
</pre>
<p>
Note: An <a href="http://ruffnekk.stormloader.com/monosubst_tool.html">online tool</a> is available.
</p>

<p>
<b>Step 4:</b>
</p>

<p>
Find the message blocks matching the next given group: 17mce 5sk 6ske.</p>
<pre>ZEKHCZUDGVWAZKQEKA<span class="kr-msg-block">NAMEBLAISEDEBLANK</span>ZEYICVGMASHICAZABCDEFGHBGQWRBFEDAZEHPTKRGFXHHMU<span class="kr-msg-block">ALLOY</span>NMIZZI
VQNHTLMKKEKIMJPOJOAOAMNAIWGRJIYDMIBCQJYGUDXTJIJKZPQVXNKENJYDRNBAOBLKJC<span class="kr-msg-block">RODENT</span>SPSVJZETUNPZTXHXB
</pre>
<p>Notice that in this step, for the first time, there are clues for both the cipher (code &ldquo;c&rdquo;) and the key (code &ldquo;k&rdquo;). The clue for the cipher is NAME BLAISE DE BLANK, which clues that this message was encrypted using the Vigenere cipher. The clue for the key is ALLOY RODENT, which clues the key BRASS RAT (the name of the MIT class rings). Decrypt the message.
</p>
<pre>Cipher key: BRASSRAT
Cipher: ZEKHCZUDGVWAZKQEKANAMEBLAISEDEBLANKZEYICVGMASHICAZABCDEFGHBGQWRBFEDAZEHPTKRGFXHHMUALLOYNMIZZI
        VQNHTLMKKEKIMJPOJOAOAMNAIWGRJIYDMIBCQJYGUDXTJIJKZPQVXNKENJYDRNBAOBLKJCRODENTSPSVJZETUNPZTXHXB
Plain:  YNKPKIUKFEWIHTQLJJNIUNBSZRSMLNBSZWKHMHIJUPMIAQIJZIAJKMEMFQBOYFRIENDIHNHWSTRONGHOLDATTXYULRZHQ
        EQUGCLUSTERHVJXWSOHNJMVIRWNQSIGLVIIBZJGODDESSIRSIPXUGNSMWJFCANJIXBSJSCZWMEUSBPADSZLSDNXHCXOWK
</pre>
<p>
Note: An <a href="http://rumkin.com/tools/cipher/vigenere.php">online tool</a> is available.
</p>

<p>
<b>Step 5:</b>
</p>

<p>
Find the message blocks matching the next given group: 9sce 10sce 7ske 7ske.</p>
<pre>YNKPKIUKFEWIHTQLJJNIUNBSZRSMLNBSZWKHMHIJUPMIAQIJZIAJKMEMFQ<span class="kr-msg-block">BOYFRIEND</span>IHNHW<span class="kr-msg-block">STRONGHOLD</span>ATTXYULRZHQ
EQUG<span class="kr-msg-block">CLUSTER</span>HVJXWSOHNJMVIRWNQSIGLVIIBZJ<span class="kr-msg-block">GODDESS</span>IRSIPXUGNSMWJFCANJIXBSJSCZWMEUSBPADSZLSDNXHCXOWK
</pre>
<p>
The clue BOYFRIEND STRONGHOLD clues that this message was encrypted using the Beaufort cipher (beau=boyfriend, fort=stronghold). The clue CLUSTER GODDESS clues the key ATHENA (the MIT computing environment). Decrypt the message.
</p>
<pre>Cipher key: ATHENA
Cipher: YNKPKIUKFEWIHTQLJJNIUNBSZRSMLNBSZWKHMHIJUPMIAQIJZIAJKMEMFQBOYFRIENDIHNHWSTRONGHOLDATTXYULRZHQ
        EQUGCLUSTERHVJXWSOHNJMVIRWNQSIGLVIIBZJGODDESSIRSIPXUGNSMWJFCANJIXBSJSCZWMEUSBPADSZLSDNXHCXOWK
Plain:  CGXPDSGJCARSTARTERNLNRMIBCPSCNZBIIDTOMZVTLOLHOFRBLHVDOWHCOMMCOQWJNXLARGEIAQQAUTFWBNHHWJKCJBMR
        AXGURWKVHWCAJEDEBTXAROYZNRNKBZYCFSLGFEUMQEAVISCPWYDGNUMBEROFEARSWGMEIYULSJGISSEKIBIPBADTRKQRQ
</pre>
<p>
Note: An <a href="http://ruffnekk.stormloader.com/beaufort_tool.html">online tool</a> is available.
</p>

<p>
<b>Step 6:</b>
</p>

<p>
Find the message blocks matching the next given group: 10mc 5ske 12mk.
</p>

<pre>CGXPDSGJ<span class="kr-msg-block">CARSTARTER</span>NLNRMIBCPSCNZBIIDTOMZVTLOLHOFRBLHVDOWHCOMMCOQWJNX<span class="kr-msg-block">LARGE</span>IAQQAUTFWBNHHWJKCJBMR
AXGURWKVHWCAJEDEBTXAROYZNRNKBZYCFSLGFEUMQEAVISCPWYDG<span class="kr-msg-block">NUMBEROFEARS</span>WGMEIYULSJGISSEKIBIPBADTRKQRQ
</pre>
<p>
The clue CAR STARTER clues that this message was encrypted using the Autokey cipher. The clue LARGE NUMBER OF EARS clues the key SMOOT (the unit used to measure the length of the Harvard Bridge). Decrypt the message.
</p>
<pre>Cipher key: SMOOT
Cipher: CGXPDSGJCARSTARTERNLNRMIBCPSCNZBIIDTOMZVTLOLHOFRBLHVDOWHCOMMCOQWJNXLARGEIAQQAUTFWBNHHWJKCJBMR
        AXGURWKVHWCAJEDEBTXAROYZNRNKBZYCFSLGFEUMQEAVISCPWYDGNUMBEROFEARSWGMEIYULSJGISSEKIBIPBADTRKQRQ
Plain:  KUJBKIMABQJGTZBKYYOKDTOURZWEIWAFEAHTJIZOACGMTODLPSTSSZEOKWNIOEUJBZTRRQHLRJAJPDKFNMKXCJXAFHSPR
        VQOFABUHCWBGCCHDVRVTOTHEUDUDXFVICVGLXCZGFHYWCNVRAWQLWUQLTVUPTHWYHNFIKRHGKZPBMIFVHPAKGTOTHEXDX
</pre>
<p>
Note: An <a href="http://rumkin.com/tools/cipher/vigenere-autokey.php">online tool</a> is available.
</p>

<p>
<b>Step 7:</b>
</p>

<p>
Find the message blocks matching the next given group: 10mk 8mke.
</p>
<pre>KUJBKIMABQJGTZBKYYOKDTOURZWEIWAFEAHTJIZOACGMTODLPSTSSZEOKWNIOEUJBZTRRQHLRJAJPDKFNMKXCJXAFHSPR
VQOFABUHCWBGCCHDVRV<span class="kr-msg-block">TOTHEUDUDX</span>FVICVGLXCZGFHYWCNVRAWQLWUQLTVUPTHWYHNFIKRHGKZPBMIFVHPAKG<span class="kr-msg-block">TOTHEXDX</span>
</pre>
<p>
The message blocks, parsed correctly, are TO THE U DU DX and TO THE X DX, which come from a common MIT cheer and clues the number <i>e</i>. The message was encrypted using the digits of <i>e</i> as a running key (also known as the Gronsfeld cipher). Decrypt the message.
</p>
<pre>Cipher: KUJBKIMABQJGTZBKYYOKDTOURZWEIWAFEAHTJIZOACGMTODLPSTSSZEOKWNIOEUJBZTRRQHLRJAJPDKFNMKXCJXAFHSPR
        VQOFABUHCWBGCCHDVRVTOTHEUDUDXFVICVGLXCZGFHYWCNVRAWQLWUQLTVUPTHWYHNFIKRHGKZPBMIFVHPAKGTOTHEXDX
Key:    271828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852
        516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988
Plain:  INITIALSZIFBKZXFWVJHXTMMKVPDFRYZYYDKCBUHYYZMKLXCGJOJNSAFEQECHYSCUXPRKKBIRGVGKZDAEIFQBGPYEAKKP
        QPIZWZNDAPXAWZYCMOTTOQHZLUSCPEOEBSBCRWXXFDVRVLMRATNHULLJNVPGOBTYAKXHHPEECTNUDECRYPTEDRLQZCOVP
</pre>
<p>
Note: An <a href="http://rumkin.com/tools/cipher/gronsfeld.php">online tool</a> is available.
</p>

<p>
<b>Final step:</b>
</p>

<p>
Find the final message blocks: 8s 9s.
</p>
<pre><span class="kr-msg-block">INITIALS</span>ZIFBKZXFWVJHXTMMKVPDFRYZYYDKCBUHYYZMKLXCGJOJNSAFEQECHYSCUXPRKKBIRGVGKZDAEIFQBGPYEAKKP
QPIZWZNDAPXAWZYCMOTTOQHZLUSCPEOEBSBCRWXXFDVRVLMRATNHULLJNVPGOBTYAKXHHPEECTNU<span class="kr-msg-block">DECRYPTED</span>RLQZCOVP
</pre>
<p>
The final clue is INITIALS DECRYPTED. We also haven&rsquo;t used the code &ldquo;e&rdquo; given in the puzzle, associated with some of the message blocks. Putting these two together, the answer extraction method is to read the initials of the message blocks that are marked with code &ldquo;e&rdquo;. However, we shouldn&rsquo;t read the initials from those message blocks directly, but rather, read the corresponding fully decrypted letters in the final plaintext message.
</p><p>
This is illustrated below. The messages from all the steps are listed below, marked with their step number (the final plaintext message is marked &ldquo;F&rdquo;). The message blocks that have associated code &ldquo;e&rdquo; are highlighted in light blue instead of yellow. Then, the letters in the final plaintext message corresponding to the initials of the light-blue message blocks are highlighted in green.
</p>
<pre>First half of message:
1: JHBXRJQDPKYGJBSHBGIGCHUMGOWHDHUMGIBJHLORKPCGWXORGJGURDHVPXUPSYTUVHDGJHXAZBTPVFXXCQGMMNLICOJJO
2: WUOKEWDQCXLTWOFUOTVTPUHZTBJUQUHZTVOWUYBEXCPTJKBETW<span class="kr-msg-block">THEQUICK</span>HCFLGHIUQTWUKNMOGCISKKPDTZZAYVPBWWB
3: LEKHCLYDGOUALKNEKATAREBWAIPEDEBWATK<span class="kr-msg-block">LEXICOGRAPHICAL</span>ABCDEFGHBGNUZBFEDALEHMQKZGFSHHRYAWWVX<span class="kr-extract-block">TRILLI</span>
4: ZEKHCZUDGVWAZKQEKA<span class="kr-extract-block">NAMEBLAISEDEBLANK</span>ZEYICVGMASHICAZABCDEFGHBGQWRBFEDAZEHPTKRGFXHHMU<span class="kr-msg-block">ALLOY</span>NMIZZI
5: YNKPKIUKFEWIHTQLJJNIUNBSZRSMLNBSZWKHMHIJUPMIAQIJZIAJKMEMFQ<span class="kr-extract-block">BOYFRIEND</span>IHNHW<span class="kr-extract-block">STRONGHOLD</span>ATTXYULRZHQ
6: CGXPDSGJ<span class="kr-msg-block">CARSTARTER</span>NLNRMIBCPSCNZBIIDTOMZVTLOLHOFRBLHVDOWHCOMMCOQWJNX<span class="kr-extract-block">LARGE</span>IAQQAUTFWBNHHWJKCJBMR
7: KUJBKIMABQJGTZBKYYOKDTOURZWEIWAFEAHTJIZOACGMTODLPSTSSZEOKWNIOEUJBZTRRQHLRJAJPDKFNMKXCJXAFHSPR
F: <span class="kr-msg-block">INITIALS</span>ZIFBKZXFWV<span class="kr-extract-ltr">J</span>HXTMMKVPDFRYZYYDKCBUHYYZMKLXCGJOJNSAFEQ<span class="kr-extract-ltr">E</span>CHYSCUXP<span class="kr-extract-ltr">R</span>KKBI<span class="kr-extract-ltr">R</span>GVGKZDAEIFQBGP<span class="kr-extract-ltr">Y</span>EAKKP
</pre>
<pre>Second half of message:
1: KSIXZMCBBHB<span class="kr-msg-block">OCEANENG</span>NGCIGOYPTE<span class="kr-extract-block">OLDCOURSE</span>LPQDFZEOEBJASKFIBHIELDTIUG<span class="kr-msg-block">NUMBER</span>TNDHIZWAWKEJHZQIAJZFXFU
2: XFVKMZPOOUOBPRNARATATPVTBLCGRBYQPBHEFRYCDQSMR<span class="kr-extract-block">BROWNFX</span>SVOUVRYQGVHTAHZOREGAQUVMJNJXRWUMDVNWMSKSH
3: <span class="kr-extract-block">ONTH</span>QWRKKEKIRJMVJVAVARTAIUGZJIXDRIBCNJXGYDSQJIJKLMNOSTKETJXDZTBAVBWKJCZVDETQPMPOJLEQYTMLQSHSB
4: VQNHTLMKKEKIMJPOJOAOAMNAIWGRJIYDMIBCQJYGUDXTJIJKZPQVXNKENJYDRNBAOBLKJC<span class="kr-extract-block">RODENT</span>SPSVJZETUNPZTXHXB
5: EQUG<span class="kr-extract-block">CLUSTER</span>HVJXWSOHNJMVIRWNQSIGLVIIBZJ<span class="kr-extract-block">GODDESS</span>IRSIPXUGNSMWJFCANJIXBSJSCZWMEUSBPADSZLSDNXHCXOWK
6: AXGURWKVHWCAJEDEBTXAROYZNRNKBZYCFSLGFEUMQEAVISCPWYDG<span class="kr-msg-block">NUMBEROFEARS</span>WGMEIYULSJGISSEKIBIPBADTRKQRQ
7: VQOFABUHCWBGCCHDVRV<span class="kr-msg-block">TOTHEUDUDX</span>FVICVGLXCZGFHYWCNVRAWQLWUQLTVUPTHWYHNFIKRHGKZPBMIFVHPAKG<span class="kr-extract-block">TOTHEXDX</span>
F: QPIZ<span class="kr-extract-ltr">W</span>ZNDAPXAWZYCMOTTOQHZLUSCP<span class="kr-extract-ltr">E</span>OEBSBCRW<span class="kr-extract-ltr">X</span>XFDVRV<span class="kr-extract-ltr">L</span>MRATNHULLJNVPGOBTYAKXHHP<span class="kr-extract-ltr">E</span>ECTNU<span class="kr-msg-block">DECRYPTED</span><span class="kr-extract-ltr">R</span>LQZCOVP
</pre>
<p>
Reading the green plaintext letters gives the final answer <b>JERRY WEXLER</b>.
</p>
